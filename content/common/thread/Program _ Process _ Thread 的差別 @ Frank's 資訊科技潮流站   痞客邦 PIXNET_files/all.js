var pix=pix||{p:{profile:{},friend:{},alb:{},blog:{},club:{},gb:{},acct:{}},f:{profile:{},friend:{},alb:{},blog:{},club:{},gb:{},acct:{}},v:{}};(function($,window,document){pix.selectHover=function(){$(".list-table tr").hover(function(){$(this).toggleClass("hover")},function(){$(this).toggleClass("hover")})};pix.checkedHighlight=function(){};pix.loaded=function(){$("#overlay").toggle();$("#overlay").css("opacity","1");$("#loading").hide()};pix.loading=function(){$("#overlay").toggle().css({opacity:"0.5",left:($(document).width()-$("#loading").width())/2,top:($(document).height()-$("#loading").height())/2}).show()};pix.annelize=function(id,action,args){var el="#post-reply-"+id+"-body";var el_text="#post-reply-"+id+"-real-body";var el_annel=$('<form class="oneTimeForm"></form>'),el_rawdata=pix.rawdata(el_text),el2,t,div_func,ismobile=!!(typeof args._ismobile!="undefined"&&true===args._ismobile);if("guestbook"===args._class){el=id;el_rawdata=pix.rawdata(el)}if("text"==args._type){el2=$('<input class="input-style input-text" name="content" type="text">')}else if("textarea"==args._type){if(ismobile){el2=$('<textarea name="content"></textarea>')}else{el2=$('<textarea class="input-style input-textarea" name="content" rows="5" style="font-size: small;width:98%"></textarea>')}}el2.val(el_rawdata);el_annel.append(el2);for(t in args){if(args.hasOwnProperty(t)){if("_"==t.substr(0,1)){continue}el2=$('<input type="hidden">').attr("name",t).val(args[t]);el_annel.append(el2)}}var submitbtn;if(ismobile){submitbtn=$('<button type="submit">').text(pixlang.save);div_func=$('<div class="comment-functions"></div>').appendTo(el_annel).append(submitbtn);el2=$('<button type="button">').text(pixlang.cancel).appendTo(div_func)}else{submitbtn=$('<input type="submit">').val(pixlang.save).appendTo(el_annel);el2=$('<input type="button">').val(pixlang.cancel).appendTo(el_annel)}el_annel.submit(function(){pix.loading();$.post(action,el_annel.serializeArray(),function(data){if(args._success){args._success(data)}else{pix.refresh()}},"json");return false});submitbtn.click(function(){el_annel.submit();return false});el2.click(function(){$(el_annel).empty();$(el).show();if(args._cancel){args._cancel()}});$(el).hide().after(el_annel)};pix.refresh=function(){document.location.reload()};pix.loadingwin=function(selector){$("#overlaywin").remove();$("#loadingwin").remove();$(selector).append('<div id="overlaywin"></div>');$(selector).append('<div id="loadingwin"><img src="//panel.pixfs.net/images/common/loading.gif" alt=""></div>');if($(selector+" #overlaywin").css("opacity")=="0.5"){return}$(selector+" #overlaywin").toggle().css("opacity","0.5");$(selector+" #loadingwin").css("left",($(selector).width()-$("#loadingwin").width())/2).css("top",($(selector).height()-$("#loadingwin").height())/2).show()};pix.loadedwin=function(selector){$(selector+" #overlaywin").toggle().css("opacity","1");$(selector+" #loadingwin").hide();$("#overlaywin").remove();$("#loadingwin").remove()};pix.blogcommentreply=function(id,action){var realid="#post-reply-"+id+"-real-body";pix.annelize(id,action,{_type:"textarea",sToken:pix.sToken,_cancel:function(){$(".post-reply-"+id+"-button").css("display","")},_success:function(obj){if(obj.result){if(obj.success){alert(obj.result);pix.refresh()}else{if(obj.result){alert(obj.result)}else{alert("系統偵測您已被登出，請儲存你輸入的文字後，重新登入及回覆。")}}}}});$(".post-reply-"+id+"-button").css("display","none")};pix.openAllCategory=function(type){var uls=$("#category ul");uls.each(function(index,dom){var ul=$(dom);if(ul.attr("id")){if("open"==type){ul.css("display","block");$("#"+ul.attr("id")+"-switch").attr("src","//s.pixfs.net/blog/images/choc/minus.gif")}else{ul.css("display","none");$("#"+ul.attr("id")+"-switch").attr("src","//s.pixfs.net/blog/images/choc/plus.gif")}}})};pix.commentSwitch=function(id,cid){var text_element=$("#"+id),switch_element=$("#"+cid);if(!text_element||!switch_element){return}if("none"==text_element.css("display")){text_element.css("display","block");switch_element.attr("src","//s.pixfs.net/blog/images/choc/minus.gif").attr("alt","close trackbacks list")}else{text_element.css("display","none");switch_element.attr("src","//s.pixfs.net/blog/images/choc/plus.gif").attr("alt","open trackbacks list")}};pix.gotoArchive=function(obj){var opi=obj.selectedIndex,opv=obj.options[opi].value;if(opv!="-pixnet-"){document.location=opv}};pix.jsonToObj=function(json){return JSON.parse(json)};pix.delArticle=function(article_id,returnToIndex){var func,obj;if(confirm(pixlang.delArticle_confirm)){if(returnToIndex){func=function(data,textStatus){obj=data;alert(obj.result);if(obj.success){location.href="/blog"}}}else{func=function(data,textStatus){alert(data.result);location.reload(true)}}$.post("/blog/manage?manageAction=delArticle&articleid="+article_id,{sToken:pix.sToken},func,"json")}};pix.delTrackback=function(tb_id,article_id){if(confirm(pixlang.delTrackback_confirm)){$.post("/blog/manage?manageAction=delTrackback&tbid="+tb_id+"&article_id="+article_id,{sToken:pix.sToken},function(data,textStatus){alert(data.result);location.reload(true)},"json")}};pix.replyComment=function(comment_id,content,callback){$.post("/blog/manage?manageAction=addblogcommentreply&blogcomment_id="+comment_id,{sToken:pix.sToken,content:content},function(data,textStatus){alert(data.result);if(callback){callback()}},"json")};pix.delComment=function(comment_id){if(confirm(pixlang.delComment_confirm)){$.post("/blog/manage?manageAction=delComment&commentid="+comment_id,{sToken:pix.sToken},function(data,textStatus){alert(data.result);location.reload(true)},"json")}};pix.spamComment=function(comment_id){var toDelete=false;if(confirm(pixlang.alsoDeleteSpam)){toDelete=true}$.post("/blog/manage?manageAction=spamComment&commentid="+comment_id,{sToken:pix.sToken,toDelete:toDelete},function(data){alert(data.result);location.reload()},"json")};pix.delReComment=function(comment_id){if(confirm(pixlang.delRecomment_confirm)){$.post("/blog/manage?manageAction=delReComment&commentid="+comment_id,{sToken:pix.sToken},function(data,textStatus){alert(data.result);location.reload(true)},"json")}};pix.hideComment=function(comment_id,toStatus){$.post("/blog/manage?manageAction=hideComment&commentid="+comment_id+"&toStatus="+toStatus,{sToken:pix.sToken},function(ret){alert(ret.result);location.reload(true)},"json")};pix.sendForwardTo=function(forwardTitle,forwardContent){window.location="mailto:?subject="+forwardTitle+"&body="+forwardContent};pix.autoImgResize=function(size,id){var i;if(size>0){$("#"+id).find("img").each(function(){i=$(this);if("blog468x60Banner"==i.parent().parent().attr("id")){return true}if(i.width()>size){var ori=i.width(),ori_h=i.height(),size_h=Math.round(ori_h*size/ori);i.width(size).height(size_h);i.mouseover(function(){$(this).width(ori).height(ori_h)}).mouseout(function(){$(this).width(size).height(size_h)})}})}};pix.fixPixnetPlayerID=function(){var objects=document.getElementsByTagName("object"),objectIDs=[],len=objects.length,i,objid;for(i=0;i<len;i++){if(objects[i].id.indexOf("PixnetPlayer")===0){objid=objects[i].id;if(objectIDs[objid]===undefined){objectIDs[objid]=1}else{objectIDs[objid]++}}}for(i=0;i<len;i++){if(objectIDs[objects[i].id]>1){objects[i].id+="_"+objectIDs[objects[i].id]++;objects[i].parentNode.innerHTML=objects[i].parentNode.innerHTML}}};pix.insertToEditArea=function(id,data){if(!tinyMCE.getInstanceById(id)){pix.addTextToTextarea(data,document.getElementById(id))}else{if(true===pix.CheckMyStr("object",data)){tinyMCE.execCommand("mceInsertContent",false,data+"&nbsp;")}else{tinyMCE.execCommand("mceInsertContent",false,data)}if($.browser.safari){tinyMCE.execCommand("mceSetContent",false,tinyMCE.getInstanceById(id).getContent())}}};pix.CheckMyStr=function(findme,alltext){if(-1==alltext.indexOf(findme)){return false}else{return true}};pix.caret=function(node){node.focus();if(node.selectionStart){return node.selectionStart}else if(!document.selection){return 0}var c="",sel=document.selection.createRange(),dul=sel.duplicate(),len=0;dul.moveToElementText(node);sel.text=c;len=dul.text.indexOf(c);sel.moveStart("character",-1);sel.text="";return len};pix.setCaretPos=function(node,pos){node.focus();if(node.selectionStart){node.selectionStart=pos;node.selectionEnd=pos;return}else if(!document.selection){return}var sel=document.selection.createRange();sel.moveStart("character",-node.value.length);sel.moveEnd("character",-node.value.length);sel.moveStart("character",pos);sel.moveEnd("character",0);sel.select()};pix.addTextToTextarea=function(mark,ta){var caretPos=pix.caret(ta);if(caretPos==-1){caretPos=ta.value.length}ta.value=ta.value.substr(0,caretPos)+mark+ta.value.substr(caretPos);pix.setCaretPos(ta,caretPos+mark.length)};pix.mailForward=function(subject,body){window.location="mailto:?subject="+subject+"&body="+body;return false};pix.forwardToGB=function(aid){var url="http://"+window.location.hostname+"/blog/importtoguestbook?aid="+aid;window.open(url,"forwardToGuestBook","width=502, height=402")};$.fn.extend({getSafePageX:function(left){return $("body").width()-left>$(this).outerWidth()?left:$("body").width()-$(this).outerWidth()},setSafePageX:function(left,offset){offset=typeof offset==="number"?offset:0;return $(this).css("left",$.fn.getSafePageX.call(this,left)+offset)},visible:function(){return $(this).css("visibility","visible")}});pix.albumPopInfo={init:function(elems){pix.albumPopInfo.elems=elems;$.each(elems,function(){var target=$("#"+this[0]),href=target.attr("href"),pop=$(href.substr(href.indexOf("#"))),load=this[1];this[2]=pop;target.click(function(e){pix.albumPopInfo.preClick();pix.albumPopInfo.click(pop,e,load);e.stopPropagation();e.cancelBubble=true;return false})})},preClick:function(){$.each(pix.albumPopInfo.elems,function(){if(this[2]&&this[2].hide){this[2].hide()}})},click:function(pop,e,load){pop.show().visible().setSafePageX(e.pageX).css("top",e.pageY);var bodyClickFunc=function(pop){return function(){pop.hide();$("body").unbind("click",bodyClickFunc)}}(pop);$("body").click(bodyClickFunc);if(typeof load=="string"){pop.load(load)}}};pix.iframePopup={init:function(div,url,button,close_button,title){$(button).live("click",function(event){$(div).find("h3").text(title);$div=$(div).show();$iframe_div=$div.find("#frame-content");$iframe_div.html('<iframe width="100%" height="100%" frameborder="0" src="'+url+'"></iframe>').width(650);$iframe=$iframe_div.find("iframe");$iframe.load(function(){$div.css("z-index",2147483647)});if($.browser.msie&&$.browser.version<8){$(document.documentElement).css("overflow","hidden")}else{$("html").css("overflow","hidden")}return false});$(close_button).click(function(){if($.browser.msie&&$.browser.version<8){$(document.documentElement).css("overflow","")}else{$("html").css("overflow","")}$div=$(div);$div.hide();return false})},preClick:function(){$.each(pix.albumPopInfo.elems,function(){if(this[2]&&this[2].hide){this[2].hide()}})},click:function(pop,e,load){pop.show().visible().setSafePageX(e.pageX).css("top",e.pageY);var bodyClickFunc=function(pop){return function(){pop.hide();$("body").unbind("click",bodyClickFunc)}}(pop);$("body").click(bodyClickFunc);if(typeof load=="string"){pop.load(load)}}};pix.hotkeyLocation=function(arr){$.each(arr,function(key,loc){if(!!loc){$(document).bind("keydown",{combi:key,disableInInput:true},function(){window.location.href=loc})}})};$(function(){$(".drop").click(function(e){e.stopPropagation();e.cancelBubble=true;var d=$("+ .drop-menu",this),s=d.css("display");$(".drop + .drop-menu").hide();if("none"==s){d.show()}});$("body").click(function(){$(".drop + .drop-menu").hide()});pix.checkedHighlight();pix.selectHover();if(window.devicePixelRatio&&$.cookie){var cookie_domain=location.hostname;if(/\.pixnet\.net$/.test(location.hostname)){cookie_domain="pixnet.net"}$.cookie("devicePixelRatio",window.devicePixelRatio,{expires:365,path:"/",domain:cookie_domain})}(function(){var _gb=$("#guestbook"),gbData=_gb.data();_gb.on("click",function(evt){if("appmarket"==gbData.action||"setting"==gbData.action){if(!confirm(gbData.msg)){evt.preventDefault()}}else if("none"==gbData.action){alert(gbData.msg);evt.preventDefault()}})})()})})(jQuery,window,document);function CopyText(id){copy(document.getElementById(id).value)}function copy_to_clipboard(id){CopyText(id)}function copy(text2copy){var flashcopier,divholder,divinfo;if(window.clipboardData){window.clipboardData.setData("Text",text2copy)}else{flashcopier="flashcopier";if(!document.getElementById(flashcopier)){divholder=document.createElement("div");divholder.id=flashcopier;document.body.appendChild(divholder)}document.getElementById(flashcopier).innerHTML="";divinfo='<embed src="/static/js/copy/_clipboard.swf" FlashVars="clipboard='+escape(text2copy)+'" width="0" height="0" type="application/x-shockwave-flash"></embed>';document.getElementById(flashcopier).innerHTML=divinfo}}function copyToClipboard(meintext){var clip,trans,str,len,copytext,clipid;if(window.clipboardData){window.clipboardData.setData("Text",meintext)}else if(window.netscape){netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect");clip=Components.classes["@mozilla.org/widget/clipboard;1"].createInstance(Components.interfaces.nsIClipboard);if(!clip){return}trans=Components.classes["@mozilla.org/widget/transferable;1"].createInstance(Components.interfaces.nsITransferable);if(!trans){return}trans.addDataFlavor("text/unicode");str={};len={};str=Components.classes["@mozilla.org/supports-string;1"].createInstance(Components.interfaces.nsISupportsString);copytext=meintext;str.data=copytext;trans.setTransferData("text/unicode",str,copytext.length*2);clipid=Components.interfaces.nsIClipboard;if(!clip){return false}clip.setData(trans,null,clipid.kGlobalClipboard)}alert(pixlang.copy_alert+meintext);return false}

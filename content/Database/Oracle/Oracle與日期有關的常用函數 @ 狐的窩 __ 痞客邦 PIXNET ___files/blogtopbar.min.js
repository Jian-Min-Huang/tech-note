window.requestTimeout=function(e,t){"use strict";function a(){var r=(new Date).getTime(),o=r-n;o>=t?e.call():i.value=window.requestAnimFrame(a)}if(!(window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame&&window.mozCancelRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame))return window.setTimeout(e,t);var n=(new Date).getTime(),i={};return i.value=window.requestAnimFrame(a),i},window.clearRequestTimeout=function(e){return window.cancelAnimationFrame?window.cancelAnimationFrame(e.value):window.webkitCancelAnimationFrame?window.webkitCancelAnimationFrame(e.value):window.webkitCancelRequestAnimationFrame?window.webkitCancelRequestAnimationFrame(e.value):window.mozCancelRequestAnimationFrame?window.mozCancelRequestAnimationFrame(e.value):window.oCancelRequestAnimationFrame?window.oCancelRequestAnimationFrame(e.value):window.msCancelRequestAnimationFrame?window.msCancelRequestAnimationFrame(e.value):clearTimeout(e)},window.requestAnimFrame=function(){"use strict";return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e){window.setTimeout(e,1e3/60)}}(),function(e){"use strict";var t={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};e.fn.replaceTpl=function(e,a){var n=/\#\{\$(.+?)\}/g,i=t;return e.replace(n,function(e){return String(a[e.replace(n,"$1")]).replace(/[&<>"'\/]/g,function(e){return i[e]})})}}(jQuery),function(e){"use strict";e.support.cssProperty=function(e){for(var t=",Webkit,Moz,O,ms,Khtml".split(","),a=t.length,n=!1,i=0;a>i&&(i&&(e=e.charAt(0).toUpperCase()+e.substr(1)),!(n=t[i]+e in document.body.style));i++);return n}}(jQuery),function(e,t,a){"use strict";var n=function(){if(-1===navigator.userAgent.indexOf("MSIE"))return!1;var e=parseInt(navigator.userAgent.split("MSIE")[1].split(";")[0]);return 9>=e}();e.fn.Search=function(i){var r=this,o=i.jqSearch,s=i.jqSearchInput,c=i.jqSearchBtn,l=i.jqSearchReset,d=i.jqSearchSuggestion,u={show:i.suggestionShowClass,item:i.suggestionItemClass,selected:i.suggestionSelectedClass};this.searchSuggestion=function(){var a={kwdCached:{},kwdTpl:{item:i.suggestionItemTpl,mark:"<mark>$1</mark>"}},n=d;return a.getKwd=function(t){if(t=e.trim(String(t)),!t.length)return a.hideKwd(),void 0;var i=a.setKwdCount();a.kwdCached[t]?a.showKwd(a.kwdCached[t],t):!function(i){e.ajax({url:"//emma.pixnet.cc/mainpage/keywords/search.json?sort=count&limit=10&q="+t,dataType:"jsonp"}).done(function(e){var r=e.keywords;e.error||(r.length?(a.kwdCached[t]=r,i===n.data("kwd-counter")&&a.showKwd(r,t)):a.hideKwd())})}(i)},a.setKwdCount=function(){var e,t=n.data("kwd-counter")||0;return n.data("kwd-counter",t+1),e=n.data("kwd-counter")},a.hideKwd=function(e){e&&n.empty(),n.removeClass(u.show)},a.showKwd=function(t,i){for(var r,o=0,s=t.length,c="",l=e("<ul />"),d=new RegExp("("+i.replace(/(\W)/g,"\\$1")+")","gi");s>o;o+=1)r=l.html(e.fn.replaceTpl(a.kwdTpl.item,{keyword:t[o]})).children("li"),r.html(r.html().replace(d,a.kwdTpl.mark)),c+=l.html();n.html(c).addClass(u.show),c=l=r=null},a.fillKwd=function(e){var t=n.find("."+u.selected);t.length&&(e=e||t.text(),s.val(e))},a.selectKwd=function(e){if(27===e)return a.hideKwd(),s.val(t.unescape(s.data("kwd"))),void 0;n.addClass(u.show);var i=n.find("li"),r=i.length,o=i.filter("."+u.selected).index(),c=38===e?-1:1,l=(o+c)%r;i.length||a.getKwd(s.val()),i.removeClass(u.selected).eq(l).addClass(u.selected),a.fillKwd()},a}(),this.checkSearchVal=function(){""===s.val()?l.hide():l.show()},this.validateForm=function(){return 0!==s[0].value.length},this.submitCount=function(e,n){var i,r=new Image(1,1),o=function(){t.clearRequestTimeout(i),a.location.href=n};r.src=e,r.onload=o,r.onerror=o,i=t.requestTimeout(o,500)},this.submit=function(){var e,t=c.find("button").eq(0),a=t.val(),n=t.data("counterlink"),i=s[0].maxLength;i<s[0].value.length&&s.val(s.val().slice(0,i)),e=o.attr("action")+"?"+o.serialize()+"&search="+a,e&&r.submitCount(n,e)},this.init=function(){if(c.on("click.switch","button",function(){var t=e(this);0!==t.index()&&c.prepend(t)}),i.autoFocusBtn){var p=location.pathname.split(/^\//)[1],f=c.find("button").filter('[value="'+p+'"]');t.setTimeout(function(){f.trigger("click.switch")},0)}o.on("submit.check",function(e){e.preventDefault(),r.validateForm()&&r.submit()}),s.on({"input.reset change.reset":r.checkSearchVal,"input.kwd change.kwd focus.kwd":function(){r.searchSuggestion.getKwd(s.val())}}),i.suggestionKeyboard&&s.on({"keydown.kwdCtrl input.kwdCtrl":function(e){var a=e.keyCode,i=s.val();switch(a){case 27:case 38:case 40:e.preventDefault(),r.searchSuggestion.selectKwd(a);break;default:n&&r.searchSuggestion.getKwd(i),s.data("kwd",t.escape(i))}}}),l.on("click.reset",function(e){e.preventDefault(),s[0].value="",r.checkSearchVal(),r.searchSuggestion.hideKwd()}),d.on("mouseenter",function(){s.blur()}).on("mouseenter.selectKwd","."+u.item,function(){e(this).siblings().removeClass(u.selected).end().addClass(u.selected)}).on("mouseleave.selectKwd","."+u.item,function(){e(this).removeClass(u.selected)}).on("click.suggestion","."+u.item,function(){r.searchSuggestion.fillKwd(),r.searchSuggestion.hideKwd(),o.submit()}),e(a).on("click.suggestion",function(t){0===e(t.target).parents().filter(o).length&&r.searchSuggestion.hideKwd()})}}}(jQuery,window,document),function(e,t,a,n,i){"use strict";e(function(){var r,o,s,c,l,d,u=function(){if(-1===navigator.userAgent.indexOf("MSIE"))return!1;var e=parseInt(navigator.userAgent.split("MSIE")[1].split(";")[0]);return 9>=e}(),p="is-active";r=function(e){return a.getElementById(e)},d={},d.win=e(t),d.doc=e(a),d.topbar=function(){var t=e(r("topbar")),a=t.find(".topbar__search"),n=t.find(".topbar__nav");return{topbar:t,search:a,announce:t.find(".topbar__announce"),relatedArticle:t.find(".topbar__related-article__block"),nav:n,searchContainer:n.find(".topbar__search-container"),notification:e(".topbar__nav .topbar__notification"),user:n.find(".topbar__user")}}(),s=function(e){var a=e.jqAnnounce,n=a.find("a"),i=e.hideClass,r={index:0,total:n.length,duration:e.duration};this.carousel=function(){!function e(){t.setTimeout(function(){var t=r.index;r.index=(t+1)%r.total,n.eq(t).add(n.eq(r.index)).toggleClass(i),e()},r.duration)}()},this.init=function(){this.carousel()}},l=function(){var n,i,r,o,s,c=this,l="block"===a.getElementsByTagName("body")[0].dataset.adsenseState;this.addTabData=function(e,t){var a=function(e){for(var t=[],a=0;a<e.length;a++){var n=c.url2ArticleData(e.eq(a).attr("href"));t.push(n)}return t}(t.find("a"));e.push({displayed:!1,name:t.data("tab-name"),articles:a})},this.deleteTabDataLastArticle=function(e){o[e].articles[4]=!1},this.pushPaEvent=function(e,t,a,n){if(n){var i=t+": "+(r.cityName||r.articleCat)+" "+a;_piq.push(["trackEvent",e,i,n])}},this.pushGaEvent=function(e,t,a){ga("topbarAarticlesTracker.send","event",e,t,a)},this.appendAd=function(t){for(var a='<li class="topbar__related-article__cat" data-tab-name="廣告"><div class="topbar__related-article__txt topbar__related-article__txt--hot">'+t[0].name+'</div><div class="topbar__related-article__showcase"><ul class="topbar__related-article-list">',n='<li class="topbar__related-article"><a class="topbar__related-article-link" href="{{ URL }}" target="_blank"><div class="topbar__related-article__img"><img src="{{ THUMB }}" onerror="this.remove()"></div><div class="topbar__related-article__title">{{ TITLE }}</div></a></li>',i=0;i<t.length;i++)a+=n.replace("{{ URL }}",t[i].click_url).replace("{{ TITLE }}",t[i].title).replace("{{ THUMB }}",t[i].file);a+="</ul></div></li>",c.addTabData(o,e(a)),d.topbar.relatedArticle.find(".topbar__related-article__showcase-block").before(a)},this.appendTabAds=function(e,t){var a,n='<a class="topbar__related-article-link" href="{{ URL }}" target="_blank"><div class="topbar__related-article__img"><img src="{{ THUMB }}" onerror="this.remove()"></div><div class="topbar__related-article__title">{{ TITLE }}</div></a>',i=d.topbar.relatedArticle.find(".topbar__related-article__cat").eq(t).find(".topbar__related-article").last();"image"===e[0].type&&(a=n.replace("{{ URL }}",e[0].click_url).replace("{{ TITLE }}",e[0].title).replace("{{ THUMB }}",e[0].file),c.deleteTabDataLastArticle(t),i.html(a))},this.appendGeneralTabAd=function(e,t){var a,n=d.topbar.relatedArticle.find(".topbar__related-article__cat").eq(t).find(".topbar__related-article").last();"js"===e[0].type&&(a=e[0].content,c.deleteTabDataLastArticle(t),n.html(a))},this.trackTabImpsEvent=function(e){var t=o[e],a=i+t.name,s="TAB ";c.pushPaEvent("TOPBAR 成效","imps",t.name,n);for(var l=0;5>l;l++)c.pushPaEvent("TOPBAR 推薦文章成效","imps",t.name,t.articles[l]);r.displayed||(r.displayed=!0,c.pushGaEvent("TOP BAR displayed","displayed")),t.displayed||(t.displayed=!0,c.pushGaEvent(s+"displayed",a)),c.pushGaEvent(s+"imps",a)},this.variableInit=function(){r=function(t){return{displayed:!1,cityName:t.travelCity,articleCat:t.articlesCategory,articlesType:t.articlesType,testVariation:t.testVariation,articleCatId:e(".article-head > .title").data("site-category-id")}}(d.topbar.relatedArticle.data()),o=function(e){for(var t=[],a=0;a<e.length;a++)c.addTabData(t,e.eq(a));return t}(d.topbar.relatedArticle.find(".topbar__related-article__cat")),n=c.url2ArticleData(location.href),i="TAB_"+r.articlesType+"_",s="固定"===r.articlesType},this.gaInit=function(){!function(e,t,a,n,i,r,o){e.GoogleAnalyticsObject=i,e[i]=e[i]||function(){(e[i].q=e[i].q||[]).push(arguments)},e[i].l=1*new Date,r=t.createElement(a),o=t.getElementsByTagName(a)[0],r.async=1,r.src=n,o.parentNode.insertBefore(r,o)}(t,a,"script","//www.google-analytics.com/analytics.js","ga");var e=function(){return r.testVariation?"UA-69603077-4":s?"UA-71151682-3":"UA-71151682-1"}();ga("create",e,"auto",{name:"topbarAarticlesTracker"}),ga("topbarAarticlesTracker.set","contentGroup1",r.cityName),ga("topbarAarticlesTracker.set","contentGroup2",r.articleCat),ga("topbarAarticlesTracker.set","contentGroup3",r.testVariation),ga("topbarAarticlesTracker.send","pageview")},this.injectAd=function(){var t=function(){var e=new RegExp("[\\?&]demo_ad_no=([^&#]*)"),t=e.exec(location.search);return null===t?"":decodeURIComponent(t[1].replace(/\+/g," "))}(),a="1754,2020,2023,2026,2029,2032";s&&(a="2116,2011,2014,2017"),e.ajaxSetup({cache:!0}),e.ajax({url:"https://falcon.pixanalytics.com/ad/json/"+a,dataType:"json",data:{version:2,ad_limit:5,demo_ad_no:t,blog_category:e("body").data("blog-site-category-id"),article_category:r.articleCatId}}).done(function(e){if(!e.error)for(var t=0,a=e.ad_slots.length;a>t;t++)e.ad_slots[t]&&e.ad_slots[t].ad_num&&(0!==t?""===e.ad_slots[t].ad_list[0].content||l?c.appendTabAds(e.ad_slots[t].ad_list,t-1):c.appendGeneralTabAd(e.ad_slots[t].ad_list,t-1):c.appendAd(e.ad_slots[t].ad_list))}),e.ajaxSetup({cache:!1})},this.bindEvents=function(){d.topbar.relatedArticle.on("click",".topbar__related-article-link",function(){var t=e(this).parent(),a=t.parent().index(".topbar__related-article-list"),r=t.index(),l=o[a],d=l.articles[r],u={cat:"推薦文章_click",action:i+l.name,label:"content_"+(r+1)};c.pushGaEvent(u.cat,u.action,u.label),s||(c.pushPaEvent("TOPBAR 成效","click",l.name,n),c.pushPaEvent("TOPBAR 推薦文章成效","click",l.name,d))}),s||d.topbar.relatedArticle.on("mouseenter",".topbar__related-article__cat",function(){var t=e(this).index(".topbar__related-article__cat");c.trackTabImpsEvent(t)})},this.bookingLinkTest=function(){function e(e){var a="imps"!==e;ga("topbarBookingLink.send","event","Booking.com",e,t,{nonInteraction:!a})}var t,a=d.topbar.relatedArticle.find(".topbar__related-article__link");a.length&&(t=a.data("test-version"),ga("create","UA-69603077-4","auto",{name:"topbarBookingLink"}),ga("topbarBookingLink.send","pageview"),e("imps"),a.on({mouseenter:function(){e("mouse over")},click:function(){e("click")}}))},this.init=function(){c.variableInit(),c.gaInit(),c.injectAd(),c.bindEvents(),c.bookingLinkTest()},this.url2ArticleData=function(e){try{var t=e.split("//")[1].split(".")[0],a=e.split("/post/")[1].split("?")[0].split("-")[0];return t+" "+a}catch(n){return!1}}},o=function(){var a=this,n=d.topbar.notification,r=n.find(".topbar__notification__counter"),o=n.find(".topbar__dropdown-lists"),s=n.find(".topbar__flip"),c=n.find(".topbar__notification__msglists"),l=parseFloat(c.css("min-height"),10),u=parseFloat(c.css("max-height"),10),f=150+u,h=6e4,m=60*h,g=24*m;this.transTime=function(e){var t=new Date(e);return{Y:t.getYear(),M:t.getMonth()+1,D:t.getDate(),h:t.getHours(),m:t.getMinutes(),s:t.getSeconds()}},this.formatTime=function(e,t){var n,i,r,o=e-t,s=a.transTime,c=s(t);switch(o/g|0){case 0:r=o/m|0,i=(o/h|0)-60*r,n=1>r?i?i+"分鐘前":"剛剛":r+"小時前";break;case 1:n="昨天"+c.h+":"+c.m;break;default:n=c.M+"月"+c.D+"日"}return n},this.formatMsgDate=function(t){for(var n,i,r,o=e("<ul />"),s=o.html(t).find(".topbar__notification__msglist__time"),c=new Date,l=s.length-1;l>=0;l--)n=new Date(1e3*e(s[l]).text()),i=a.formatTime(c,n),r=n.toLocaleString(),e(s[l]).html(i).attr({title:r}),n=i=null;return t=o.html()},this.ajaxCounter=function(e){if(e)return e===n.data("ajax-counter");var t=n.data("ajax-counter")||0,a=t+1;return n.data("ajax-counter",a),a},this.getData=function(){if(!n.hasClass("ajax-loading")&&!o.hasClass(p)){if(n[0].className=n.data("className"),n.addClass("ajax-loading"),"0"===r.attr("data-counter")&&n.data("latestNotification"))return c.html(a.formatMsgDate(n.data("latestNotification").html)),setTimeout(function(){n.removeClass("ajax-loading")},0),void 0;var t=a.ajaxCounter();e.ajaxSetup({cache:!0}),e.ajax({url:"//api.pixnet.cc/notification/notifyentries",dataType:"json",xhrFields:{withCredentials:!0}}).done(function(e){e.error?n.addClass("ajax-error"):(n.addClass("ajax-success").data("latestNotification",e),a.ajaxCounter(t)&&e.latestTime!==n.data("latestTime")&&(c.html(a.formatMsgDate(e.html)),n.addClass("ajax-done"),a.latestTime(e.latestTime)),a.counterNum(0))}).fail(function(){n.addClass("ajax-error")}).always(function(){setTimeout(function(){n.removeClass("ajax-loading")},0)})}},this.resize=function(){var e=d.win.height();f>e&&e>l&&c.css("max-height",e-150)},this.latestTime=function(e){return e?(n.data("latestTime",e),void 0):n.data("latestTime")},this.counterNum=function(e){var t,a,n="no-notification";return e===i?r.attr("data-counter"):(e=Number(e),t=r.hasClass(n),a=0===e,a||t?a!==t&&(r.attr("data-counter",e),r.toggleClass(n)):r.attr("data-counter",e),void 0)},this.toggleShowHide=function(){r.on("click",function(e){e.preventDefault(),a.getData(),r.toggleClass(p),o.toggleClass(p),a.resetFlip()}),d.doc.on("click",function(t){var a=t.target,i=e(a).parents().filter(n).length;i||(r.removeClass(p),o.removeClass(p))})},this.resetFlip=function(){s.removeClass("is-flipping")},this.toggleFlip=function(){s.toggleClass("is-flipping")},this.checkUnreadNotiCount=function(){!function i(){t.setTimeout(function(){var r=n.data("latestTime"),o=a.counterNum();e.ajaxSetup({cache:!0}),e.ajax({url:"//api.pixnet.cc/notification/getunreadnotifyinfo",type:"GET",dataType:"json",data:{latestTime:r},xhrFields:{withCredentials:!0}}).done(function(e){var t=e.unreadNotifyCount;t&&t!==o&&a.counterNum(t)}).fail(function(){t.console&&t.console.log("ajax error: /api/getunreadnotifyinfo")}).always(function(){i()})},6e4)}()},this.init=function(){n.data("className",n[0].className),d.win.on("resize.notification",a.resize),a.toggleShowHide(),n.find(".topbar__notification__list--header__title").on("click",a.toggleFlip),n.find(".topbar__flip--back").on("click",function(e){e.preventDefault(),a.toggleFlip()}),a.checkUnreadNotiCount(),t.setTimeout(function(){d.win.trigger("resize.notification")},0)}},c=function(){var t=d.topbar.searchContainer.find(".topbar__search__toggle-btn");this.init=function(){t.on("click",function(){d.topbar.search.toggle(),t.toggleClass(p)}),d.doc.on("click",function(a){var n=a.target,i=e(n).parents().filter(d.topbar.searchContainer).length;i||(d.topbar.search.toggle(!1),t.toggleClass(p,!1))})}},function(){function t(){if(!e("#mib-video-expander").length)return d.win.on("scroll.elementfixed",function(){var t=e(".sendpulse-bar");t.length&&(t.addClass("sendpulse-bar--fixed"),d.win.off(".elementfixed"))}),d.win.on("load",function(){e(".sendpulse-bar").addClass("sendpulse-bar--fixed"),d.win.off(".elementfixed")}),void 0;var t=a.getElementsByClassName("main-container");t&&(t=t[0],d.topbar.topbar.removeClass("topbar--fixed"),d.win.on("scroll.elementfixed",function(){var a=e(".sendpulse-bar"),n=t.getBoundingClientRect().top<=0;d.topbar.topbar.toggleClass("topbar--fixed",n),a.toggleClass("sendpulse-bar--fixed",n)}))}d.topbar.topbar.addClass(function(){for(var t=[e.support.cssProperty("animation"),e.support.cssProperty("borderRadius"),e.support.cssProperty("boxShadow"),!u],a=["cssanimations","borderradius","boxshadow","cssgradients"],n=t.length-1;n>=0;n--)t[n]||(a[n]="no-"+a[n]);return a.join(" ")}),n.f.topbar=n.f.topbar||{option:{search:!0,announce:!0,notification:!0,searchContainer:!0,relatedArticle:!0}};var i=function(){var e=d.topbar.search;return{jqSearch:e,jqSearchInput:e.find(".topbar__search__input"),jqSearchBtn:e.find(".topbar__search__btns"),jqSearchReset:e.find(".topbar__search__reset"),jqSearchSuggestion:e.find(".topbar__search__suggestion"),suggestionItemTpl:'<li class="topbar__search__suggestion__item">#{$keyword}</li>',suggestionItemClass:"topbar__search__suggestion__item",suggestionShowClass:"topbar__search__suggestion--show",suggestionSelectedClass:"topbar__search__suggestion__item--selected",suggestion:!0,suggestionKeyboard:!0,autoFocusBtn:!1}}(),r={jqAnnounce:d.topbar.announce,hideClass:"topbar__announce__item--hide",duration:6e3};e.fn.Search&&(n.f.topbar.search=new e.fn.Search(i)),n.f.topbar.announce=new s(r),d.topbar.notification.length&&(n.f.topbar.notification=new o),d.topbar.searchContainer.length&&(n.f.topbar.searchContainer=new c),d.topbar.relatedArticle.length&&(n.f.topbar.relatedArticle=new l);for(var p in n.f.topbar)n.f.topbar.hasOwnProperty(p)&&"option"!==p&&n.f.topbar.option[p]&&n.f.topbar[p].init();t()}()}),function(){function i(){t.innerWidth>=1280&&(y.addClass("show-sidebar"),x=!0),k.on("scroll.sidebarshift",function(){if(x){if(C.css("left",-t.pageXOffset),T.hasClass("topbar--fixed")){var e=Math.max(220-t.pageXOffset,0);T.css("left",e)}_&&(A=k.scrollTop()-T.offset().top>=0,C.toggleClass("sidebar--fixed",A),A||T.attr("style",""))}}),k.on("resize.toggleSidebar",function(){!x&&t.innerWidth>=1280?x=!0:x&&t.innerWidth<1280&&(C.attr("style",""),T.attr("style",""),x=!1),y.toggleClass("show-sidebar",x)}),C.on("click",".keyword-tag",function(){for(var t=e(this).index(),a=C.find(".keyword-tag"),n=0;n<a.length;n++)a.eq(n).toggleClass("active",t===n);C.find(".keyword-articles-container").css("margin-left",-220*t+"px"),l(v,"tab imps",e(this).text())}),C.on("click",".keyword-article",function(){var t=e(this).parent().index(),a=e(".keyword-tag").eq(t).text(),n=o(this.href);l(v,"article clicked",a),n&&_piq.push(["trackEvent","search sidebar - click article",a,n.author,n.id])}),setTimeout(function(){_=e("#mib-video-expander").length,_&&(A=!1,C.removeClass("sidebar--fixed"))},0)}function r(e){return e.split("//")[1].split("#")[0].split("?")[0].split("-")[0].replace(/.\w+\.test\.pixnet/,"").replace(/.\w+\.alpha\.pixnet/,"")}function o(e){var t=r(e).split(".pixnet.net/blog/post/");return 2===t.length&&parseInt(t[1])?{id:parseInt(t[1]),author:t[0]}:!1}function s(){var e="; "+a.cookie,t=e.split("; keyword_sidebar=");return 2>t.length?{}:JSON.parse(t[1].split(";")[0])}function c(e,t){var n=s(),i=r(location.href);n[i]=e+","+t,a.cookie="keyword_sidebar="+JSON.stringify(n)+";domain=."+location.host.replace(/\w+\./,"")+";path=/"}function l(e,t,a){var n="article clicked"===t;ga("sidebarTracker.send","event",e,t,a,{nonInteraction:!n})}function d(){!function(e,t,a,n,i,r,o){e.GoogleAnalyticsObject=i,e[i]=e[i]||function(){(e[i].q=e[i].q||[]).push(arguments)},e[i].l=1*new Date,r=t.createElement(a),o=t.getElementsByTagName(a)[0],r.async=1,r.src=n,o.parentNode.insertBefore(r,o)}(t,a,"script","//www.google-analytics.com/analytics.js","ga"),ga("create","UA-65168598-14","auto","sidebarTracker"),ga("sidebarTracker.send","pageview"),S&&l("from search","1. sampling")}function u(){var e=s(),t=function(){return a.referrer?r(a.referrer):""}();t&&e[t]&&(w=function(){var a=e[t].split(",");return 2!==a.length?!1:{username:a[0],id:a[1]}}(),q||f())}function p(){w=b,f()}function f(){if(w){e.ajaxSetup({cache:!0});var t=e.ajax({url:"http://emma.pixnet.cc/blogarticles/topkeywords",dataType:"json",data:{user_name:w.username,article_id:w.id}}),a=e.ajax({url:"https://emma.pixnet.cc/blog/articles/"+w.id,dataType:"json",data:{user:w.username}}),n=e.ajax({url:"http://emma.pixnet.cc/blog/articles/"+w.id+"/ypa",dataType:"json",data:{user:w.username}});e.ajaxSetup({cache:!1}),e.when(a,t,n).done(function(e,t,a){if(d(),e[0]&&!e[0].error&&t[0]){if(S){if(l("from search","2. in search console"),q)return;l("from search","3. sidebar exist")}m(e[0].article,t[0],a[0])}})}}function h(t){function n(e){return encodeURIComponent(e).replace(/(%[A-F\d]{2}){3}/g,"UU").length}function i(e,t){if(e=e.replace(/\n/g,""),n(e)<=2*t)return e;for(var a=t;a<e.length;a++){var i=e.substr(0,a);if(n(i)>2*t)return e.substr(0,a-1)+"..."}}var o="",s="",c='<span class="keyword-tag {% ACTIVE %}">{% KEYWORD %}</span> ',d='<a class="keyword-article keyword-article-min70 {% ACTIVE %}" href="{% LINK %}"><h3 class="keyword-article__title">{% TITLE %}</h3></a>',u=r(location.href),p=function(e,t,a){var n=r(e.url)===u?"active":"";return a&&(e.title=i(e.title,25)),d.replace("{% ACTIVE %}",n).replace("{% LINK %}",e.url).replace("{% TITLE %}",e.title)},f=0;e.each(t.keywordsArticles,function(e,n){var i=o?"":"active";o+=c.replace("{% KEYWORD %}",e).replace("{% ACTIVE %}",i),s+='<div class="keyword-articles">',s+=p(t.topArticle,e,!0);for(var r=0;r<n.length;r++)if(s+=p(n[r],e),3===r%4){var l=(r-3)/4,d=t.ypaIframes[(r-3)/4],u="w_sidebar_"+d.type+"_h"+(new Date).getHours()+"_"+a.location.hostname.slice(0,1),h="sidebar_ypa_"+f+"_"+l,m='<iframe class="sitemaji-ypa-ad" src="http://pixnet.net/pixnet_ypa_iframe.html?q='+d.q+"&site="+u+"&cssdesktop="+d.cssUrl+"&adcount=1&id="+h+'" frameborder="0" style="width:100%"></iframe>';s+=m}s+="</div>",f++}),C.find(".keyword-tags").html(o),C.find(".keyword-articles-container").html(s).css("top",C.find(".keyword-tags").height()+55),l(v,"tab imps",e(".keyword-tag").eq(0).text())}function m(e,t,a){(!a||a.error)&&(a={ypa:[]}),h({topArticle:{title:e.title,url:e.link},keywordsArticles:t,ypaIframes:a.ypa}),i(),c(w.username,w.id),C.find(".sitemaji-ypa-ad").each(function(){this.src=this.src})}function g(e){var a=new RegExp("[?&]"+e+"=([^&]*)").exec(t.location.search);return a&&decodeURIComponent(a[1].replace(/\+/g," "))}var w,_,b=function(){var t,a;return location.href.match(/www.pixnet.net/)?a=n.visitor:(t=e("meta[name=author]").attr("content").split(" ("),a=t[t.length-1].split(")")[0]),{username:a,id:e("body").data("article-id")}}(),v=b.username+" "+b.id,k=e(t),y=e("body"),C=e(".sidebar"),T=e("#topbar"),x=!1,A=!0,j=["sweetmemory99","meiko1101","zine1215","ahuiliao"].indexOf(b.username.toLowerCase())+1,q=C.data("obstruct"),S=function(e){return e?e.match(/www\.google\.com/)||e.match(/search\.yahoo\.com/)||e.match(/www\.bing\.com/)||e.match(/www\.pixnet\.net\/searcharticle/)?!0:C.data("search"):"search"===C.data("search")}(a.referrer),E=function(){var e=new Date;return e>=new Date("2016-05-04 16:00")&&e<new Date("2016-05-09 16:00")}();(b&&b.id||location.href.match(/www.pixnet.net/))&&(g("show_sidebar")&&(q=!1,j=!0,E=!0,S=!0),j&&E&&(S||q||u(),S&&p()))}()}(jQuery,window,document,pix);
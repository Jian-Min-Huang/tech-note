<!DOCTYPE html>
<!-- saved from url=(0040)http://www.eion.com.tw/Blogger/?Pid=1174 -->
<html lang="zh-TW" class="no-touch no-svg"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

<script src="./SQL 找出欄位值重覆的記錄及刪除重複記錄_files/ca-pub-3174848791099762.js"></script><script async="" src="./SQL 找出欄位值重覆的記錄及刪除重複記錄_files/analytics.js"></script><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-3356152-3', 'auto');
ga('send', 'pageview');</script>
<meta name="author" content="designer by www.eion.com.tw">
<title>SQL 找出欄位值重覆的記錄及刪除重複記錄</title>
<meta name="description" content="ACCESS 資料表的部份欄位可能會有相同的值，匯總數據之聚合函數與分組 GROUP BY 敘述句搭配聚合函數 Aggregate Function 使用，將查詢結果中特定欄位值相同的資料分為若干個群組">
<meta name="keywords" content="SQL,ACCESS,重複記錄,聚合函數,GROUP BY,ADODB,Connection,OLEDB">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="stylesheet" href="./SQL 找出欄位值重覆的記錄及刪除重複記錄_files/sheet.global.css">
<link rel="stylesheet" type="text/css" href="./SQL 找出欄位值重覆的記錄及刪除重複記錄_files/textually.built.css">
<link rel="stylesheet" href="./SQL 找出欄位值重覆的記錄及刪除重複記錄_files/sheet.media.css">
<script src="./SQL 找出欄位值重覆的記錄及刪除重複記錄_files/jquery-1.11.2.min.js"></script>
<script src="./SQL 找出欄位值重覆的記錄及刪除重複記錄_files/lib.min.js"></script>
<script src="./SQL 找出欄位值重覆的記錄及刪除重複記錄_files/library.min.js"></script>
<script src="./SQL 找出欄位值重覆的記錄及刪除重複記錄_files/blogger.min.js"></script>
<link rel="shortcut icon" href="http://www.eion.com.tw/Blogger/styles/favicon.ico?ver=1.6.2" type="image/x-icon">
<link rel="apple-touch-icon" sizes="57x57" href="http://www.eion.com.tw/Blogger/images/apple-touch-57x57.png">
<link rel="apple-touch-icon" sizes="72x72" href="http://www.eion.com.tw/Blogger/images/apple-touch-72x72.png">
<link rel="apple-touch-icon" sizes="114x114" href="http://www.eion.com.tw/Blogger/images/apple-touch-114x114.png">
<link rel="apple-touch-icon" sizes="144x144" href="http://www.eion.com.tw/Blogger/images/apple-touch-144x144.png">
<script src="./SQL 找出欄位值重覆的記錄及刪除重複記錄_files/SyntaxHighlighter.min.js"></script><script src="./SQL 找出欄位值重覆的記錄及刪除重複記錄_files/SyntaxHighlighter.Prettify.js"></script><link rel="stylesheet" href="./SQL 找出欄位值重覆的記錄及刪除重複記錄_files/D1174.css"></head>
<body data-analytics="EOR8MU_EMIS" debug="false">
<div class="frame-stage" data-user=""><div class="frame-body"><div class="contents frame-matrix"><div class="domintro"><div class="sponsor-top"><div><script async="" src="./SQL 找出欄位值重覆的記錄及刪除重複記錄_files/adsbygoogle.js"></script><ins class="adsbygoogle" style="display:inline-block;width:728px;height:15px" data-ad-client="ca-pub-3174848791099762" data-ad-slot="0831474494" data-adsbygoogle-status="done"><ins id="aswift_0_expand" style="display:inline-table;border:none;height:15px;margin:0;padding:0;position:relative;visibility:visible;width:728px;background-color:transparent"><ins id="aswift_0_anchor" style="display:block;border:none;height:15px;margin:0;padding:0;position:relative;visibility:visible;width:728px;background-color:transparent"><iframe width="728" height="15" frameborder="0" marginwidth="0" marginheight="0" vspace="0" hspace="0" allowtransparency="true" scrolling="no" allowfullscreen="true" onload="var i=this.id,s=window.google_iframe_oncopy,H=s&amp;&amp;s.handlers,h=H&amp;&amp;H[i],w=this.contentWindow,d;try{d=w.document}catch(e){}if(h&amp;&amp;d&amp;&amp;(!d.body||!d.body.firstChild)){if(h.call){setTimeout(h,0)}else if(h.match){try{h=s.upd(h,i)}catch(e){}w.location.replace(h)}}" id="aswift_0" name="aswift_0" style="left:0;position:absolute;top:0;width:728px;height:15px;" src="./SQL 找出欄位值重覆的記錄及刪除重複記錄_files/saved_resource.html"></iframe></ins></ins></ins><script>(adsbygoogle = window.adsbygoogle || []).push({});</script></div></div>
<div class="categorization"><a href="http://www.eion.com.tw/Blogger/?f=Category&amp;Categorization=Programming">程式語法<b data-counter="28"></b></a><a href="http://www.eion.com.tw/Blogger/?f=Category&amp;Categorization=ASP"><strong>ASP</strong><b data-counter="15"></b></a><span>SQL 找出欄位值重覆的記錄及刪除重複記錄</span></div>
<div class="textually textually-content"><div class="dynamically" data-css="1174">
<h1><b>SQL</b> 找出欄位值重覆的記錄及刪除重複記錄</h1>
<h2><b>GROUP BY</b> 計算出相符的資料值</h2>
<p>某情況下 <b>ACCESS</b> 資料表的部份欄位可能會有相同的值，匯總數據之聚合函數與分組 <b class="sql">GROUP BY</b> 敘述句搭配聚合函數 <b>Aggregate Function</b> 使用，將查詢結果中特定欄位值相同的資料分為若干個群組，而每一個群組都會傳回一個資料列。若沒有使用 <b class="sql">GROUP BY</b> 聚合函數針對一個 <b class="sql">SELECT</b> 查詢，只會返回一個彙總值。</p>
<pre class="lang-sql shCode highlight Brush-default shCode-has lines-scroll"><span class="typ">Server</span><span class="pun">.</span><span class="typ">CreateObject</span><span class="pun">(</span><span class="str">"ADODB.Connection"</span><span class="pun">)</span><span class="pln"><br></span><span class="typ">Provider</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Microsoft</span><span class="pun">.</span><span class="typ">Jet</span><span class="pun">.</span><span class="pln">OLEDB</span><span class="pun">.</span><span class="lit">4.0</span></pre>
<h3><b>Store_Information</b> 資料表內容</h3>
<pre class="lang-sql shCode highlight Brush-default shCode-has lines-scroll"><span class="kwd">SELECT</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> </span><span class="kwd">FROM</span><span class="pln"> </span><span class="typ">Store_Information</span><span class="pln"> </span><span class="kwd">ORDER</span><span class="pln"> </span><span class="kwd">BY</span><span class="pln"> S_Index</span></pre>
<pre class="lang-asp shCode highlight Brush-default shCode-has lines-scroll"><span class="typ">Do</span><span class="pln"> while NOT rs</span><span class="pun">.</span><span class="pln">EOF<br>&nbsp; </span><span class="kwd">Response.Write</span><span class="pln"> rs</span><span class="pun">(</span><span class="str">"S_Index"</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> rs</span><span class="pun">(</span><span class="str">"S_Name"</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> rs</span><span class="pun">(</span><span class="str">"S_Qty"</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> rs</span><span class="pun">(</span><span class="str">"S_Date"</span><span class="pun">)</span><span class="pln"><br>rs</span><span class="pun">.</span><span class="typ">MoveNext</span><span class="pln"><br>loop</span></pre>
<table class="D4"><tbody><tr><th><span>索引鍵</span><b>S_Index</b></th><th><span>倉庫名稱</span><b>S_Name</b></th><th><span>庫存量</span><b>S_Qty</b></th><th><span>單據日期</span><b>S_Date</b></th></tr>
<tr><td>1</td><td>Los Angeles</td><td>900</td><td>2014/03/05</td></tr>
<tr><td>2</td><td>San Diego</td><td>1500</td><td>2014/03/07</td></tr>
<tr><td>3</td><td>Los Angeles</td><td>300</td><td>2014/03/12</td></tr>
<tr><td>4</td><td>Boston</td><td>1200</td><td>2014/03/08</td></tr>
<tr><td>5</td><td>Boston</td><td>1200</td><td>2014/03/08</td></tr>
<tr><td>6</td><td>New Jersey</td><td>700</td><td>2014/03/18</td></tr>
<tr><td>7</td><td>Taiwan</td><td>850</td><td>2014/09/08</td></tr>
<tr><td>8</td><td>Boston</td><td>200</td><td>2014/03/10</td></tr></tbody></table>
<h2>找出欄位值重覆的記錄</h2>
<h3><b class="steps">1</b> 找出倉庫名稱及日期均相同的記錄(兩個欄位均相同)</h3>
<p><b class="sql">GROUP BY</b> 計算出相同的 <b class="g">S_Name</b> 及 <b class="g">S_Date</b> 資料記錄，條件為倉庫名稱及日期均相同。</p>
<p>並且由變數 <b>SelectIndex</b> 保留列出結果的索引鍵。</p>
<pre class="lang-sql shCode highlight Brush-default shCode-has lines-scroll"><span class="kwd">SELECT</span><span class="pln"> </span><span class="kwd">MAX</span><span class="pun">(</span><span class="pln">S_Index</span><span class="pun">),</span><span class="pln"> S_Name</span><span class="pun">,</span><span class="pln"> S_Date<br>&nbsp; &nbsp;</span><span class="kwd">FROM</span><span class="pln"> </span><span class="typ">Store_Information</span><span class="pln"><br>&nbsp; &nbsp;</span><span class="kwd">GROUP</span><span class="pln"> </span><span class="kwd">BY</span><span class="pln"> S_Name</span><span class="pun">,</span><span class="pln"> S_Date </span><span class="kwd">HAVING</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">COUNT</span><span class="pun">(*)</span><span class="pln"> </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span></pre>
<pre class="lang-asp shCode highlight Brush-default shCode-has lines-scroll"><span class="kwd">Dim</span><span class="pln"> </span><span class="typ">SelectIndex</span><span class="pln"><br></span><span class="typ">Do</span><span class="pln"> while NOT rs</span><span class="pun">.</span><span class="pln">EOF<br>&nbsp; </span><span class="kwd">Response.Write</span><span class="pln"> rs</span><span class="pun">(</span><span class="lit">0</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> rs</span><span class="pun">(</span><span class="str">"S_Name"</span><span class="pun">)</span><span class="pln"><br>&nbsp; </span><span class="typ">SelectIndex</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">SelectIndex</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> rs</span><span class="pun">(</span><span class="lit">0</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">","</span><span class="pln"><br>rs</span><span class="pun">.</span><span class="typ">MoveNext</span><span class="pln"><br>loop</span></pre>
<table class="D2"><tbody><tr><th><b>S_Index</b> rs(<strong>0</strong>)</th><th><b>S_Name</b></th></tr>
<tr><td>5</td><td>Boston</td></tr>
<tr><td>8</td><td>Boston</td></tr>
<tr><td>1</td><td>Los Angeles</td></tr>
<tr><td>3</td><td>Los Angeles</td></tr>
<tr><td>6</td><td>New Jersey</td></tr>
<tr><td>2</td><td>San Diego</td></tr>
<tr><td>7</td><td>Taiwan</td></tr></tbody></table>
<p>由列出的記錄中得到索引鍵 <b class="o">5, 8, 1, 3, 6, 2, 7,</b></p>
<p><b class="g">IN</b> 搭配 <b class="g">WHERE</b> 子句可以用來限定必需符合某些欄位值為條件，來搜尋資料表中的特定(已知)資料記錄。</p>
<p>相反的 <b class="sql">NOT IN</b> 就是不包含在這範圍裡的的資料記錄。</p>
<pre class="lang-sql shCode highlight Brush-default shCode-has lines-scroll"><span class="kwd">SELECT</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> </span><span class="kwd">FROM</span><span class="pln"> </span><span class="typ">Store_Information</span><span class="pln"><br>&nbsp; &nbsp;</span><span class="kwd">WHERE</span><span class="pln"> S_Index </span><span class="kwd">NOT</span><span class="pln"> </span><span class="kwd">IN</span><span class="pln"> </span><span class="pun">(</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="typ">SelectIndex</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="pun">)</span><span class="pln"> </span><span class="kwd">ORDER</span><span class="pln"> </span><span class="kwd">BY</span><span class="pln"> S_Index</span></pre>
<pre class="lang-asp shCode highlight Brush-default shCode-has lines-scroll"><span class="typ">Do</span><span class="pln"> while NOT rs</span><span class="pun">.</span><span class="pln">EOF<br>&nbsp; </span><span class="kwd">Response.Write</span><span class="pln"> rs</span><span class="pun">(</span><span class="str">"S_Index"</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> rs</span><span class="pun">(</span><span class="str">"S_Name"</span><span class="pun">)</span><span class="pln"><br>rs</span><span class="pun">.</span><span class="typ">MoveNext</span><span class="pln"><br>loop</span></pre>
<p>使用 <b class="sql">NOT IN</b> 相反的列出不包含在這範圍裡的。只有索引鍵 <b class="o">4</b> 的 <b>Boston</b> 欄位值重覆的記錄。</p>
<table class="D2"><tbody><tr><th><b>S_Index</b></th><th><b>S_Name</b></th></tr>
<tr><td>4</td><td>Boston</td></tr></tbody></table>
<h3><b class="steps">2</b> 找出僅倉庫名稱相同的記錄</h3>
<p><b class="sql">GROUP BY</b> 計算出相同的資料值 <b class="g">S_Name</b> 為倉庫名稱相同。</p>
<pre class="lang-sql shCode highlight Brush-default shCode-has lines-scroll"><span class="kwd">SELECT</span><span class="pln"> </span><span class="kwd">MAX</span><span class="pun">(</span><span class="pln">S_Index</span><span class="pun">),</span><span class="pln"> S_Name<br>&nbsp; &nbsp;</span><span class="kwd">FROM</span><span class="pln"> </span><span class="typ">Store_Information</span><span class="pln"><br>&nbsp; &nbsp;</span><span class="kwd">GROUP</span><span class="pln"> </span><span class="kwd">BY</span><span class="pln"> S_Name </span><span class="kwd">HAVING</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">COUNT</span><span class="pun">(*)</span><span class="pln"> </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span></pre>
<pre class="lang-asp shCode highlight Brush-default shCode-has lines-scroll"><span class="kwd">Dim</span><span class="pln"> </span><span class="typ">SelectIndex</span><span class="pln"><br></span><span class="typ">Do</span><span class="pln"> while NOT rs</span><span class="pun">.</span><span class="pln">EOF<br>&nbsp; </span><span class="kwd">Response.Write</span><span class="pln"> rs</span><span class="pun">(</span><span class="lit">0</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> rs</span><span class="pun">(</span><span class="str">"S_Name"</span><span class="pun">)</span><span class="pln"><br>&nbsp; </span><span class="typ">SelectIndex</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">SelectIndex</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> rs</span><span class="pun">(</span><span class="lit">0</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="str">","</span><span class="pln"><br>rs</span><span class="pun">.</span><span class="typ">MoveNext</span><span class="pln"><br>loop</span></pre>
<table class="D2"><tbody><tr><th><b>S_Index</b> rs(<strong>0</strong>)</th><th><b>S_Name</b></th></tr>
<tr><td>8</td><td>Boston</td></tr>
<tr><td>3</td><td>Los Angeles</td></tr>
<tr><td>6</td><td>New Jersey</td></tr>
<tr><td>2</td><td>San Diego</td></tr>
<tr><td>7</td><td>Taiwan</td></tr></tbody></table>
<p>列出的記錄中得到索引鍵 <b class="o">8, 3, 6, 2, 7,</b></p>
<pre class="lang-sql shCode highlight Brush-default shCode-has lines-scroll"><span class="kwd">SELECT</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> </span><span class="kwd">FROM</span><span class="pln"> </span><span class="typ">Store_Information</span><span class="pln"><br>&nbsp; &nbsp;</span><span class="kwd">WHERE</span><span class="pln"> S_Index </span><span class="kwd">NOT</span><span class="pln"> </span><span class="kwd">IN</span><span class="pln"> </span><span class="pun">(</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="typ">SelectIndex</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="pun">)</span><span class="pln"> </span><span class="kwd">ORDER</span><span class="pln"> </span><span class="kwd">BY</span><span class="pln"> S_Index</span></pre>
<pre class="lang-asp shCode highlight Brush-default shCode-has lines-scroll"><span class="typ">Do</span><span class="pln"> while NOT rs</span><span class="pun">.</span><span class="pln">EOF<br>&nbsp; </span><span class="kwd">Response.Write</span><span class="pln"> rs</span><span class="pun">(</span><span class="str">"S_Index"</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> rs</span><span class="pun">(</span><span class="str">"S_Name"</span><span class="pun">)</span><span class="pln"><br>rs</span><span class="pun">.</span><span class="typ">MoveNext</span><span class="pln"><br>loop</span></pre>
<p>使用 <b class="sql">NOT IN</b> 相反的列出結果，不包含在這範圍裡的有三筆，倉庫名稱相同欄位值重覆的記錄。</p>
<table class="D2"><tbody><tr><th><b>S_Index</b></th><th><b>S_Name</b></th></tr>
<tr><td>1</td><td>Los Angeles</td></tr>
<tr><td>4</td><td>Boston</td></tr>
<tr><td>5</td><td>Boston</td></tr></tbody></table>
<h2>刪除重複記錄</h2>
<p>同樣使用 <b class="sql">NOT IN</b> 刪除結果。</p>
<pre class="lang-sql shCode highlight Brush-default shCode-has lines-scroll"><span class="kwd">DELETE</span><span class="pln"> </span><span class="kwd">FROM</span><span class="pln"> </span><span class="typ">Store_Information</span><span class="pln"><br>&nbsp; &nbsp;</span><span class="kwd">WHERE</span><span class="pln"> S_Index </span><span class="kwd">NOT</span><span class="pln"> </span><span class="kwd">IN</span><span class="pln"> </span><span class="pun">(</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="typ">SelectIndex</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="pun">)</span></pre>
<br><br><br>
<h1><b>Aggregate Function</b> 聚合函數</h1>
<p><b>Aggregate Function</b> 聚合函數，指的也就是 <b class="sql">AVG()</b>、<b class="sql">COUNT()</b>、<b class="sql">MAX()</b>、<b class="sql">MIN()</b>、<b class="sql">SUM()</b> 等這些內建函數。</p>
<h2><b>SUM</b></h2>
<h3>統計倉庫名稱相同的庫存量</h3>
<pre class="lang-sql shCode highlight Brush-default shCode-has lines-scroll"><span class="kwd">SELECT</span><span class="pln"> S_Name</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">SUM</span><span class="pun">(</span><span class="pln">S_Qty</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp;</span><span class="kwd">FROM</span><span class="pln"> </span><span class="typ">Store_Information</span><span class="pln"> </span><span class="kwd">GROUP</span><span class="pln"> </span><span class="kwd">BY</span><span class="pln"> S_Name</span></pre>
<table class="D2"><tbody><tr><th><b>S_Name</b></th><th><b>S_Qty</b> rs(<strong>1</strong>)</th></tr>
<tr><td>Boston</td><td>2600</td></tr>
<tr><td>Los Angeles</td><td>1200</td></tr>
<tr><td>New Jersey</td><td>700</td></tr>
<tr><td>San Diego</td><td>1500</td></tr>
<tr><td>Taiwan</td><td>850</td></tr></tbody></table>
<p>加入 <b class="sql">WHERE</b> 條件，統計庫存量小於 <b class="n">1000</b> 的倉庫記錄。</p>
<pre class="lang-sql shCode highlight Brush-default shCode-has lines-scroll"><span class="kwd">SELECT</span><span class="pln"> S_Name</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">SUM</span><span class="pun">(</span><span class="pln">S_Qty</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp;</span><span class="kwd">FROM</span><span class="pln"> </span><span class="typ">Store_Information</span><span class="pln"><br>&nbsp; &nbsp;</span><span class="kwd">WHERE</span><span class="pln"> S_Qty </span><span class="pun">&lt;</span><span class="pln"> </span><span class="lit">1000</span><span class="pln"> </span><span class="kwd">GROUP</span><span class="pln"> </span><span class="kwd">BY</span><span class="pln"> S_Name</span></pre>
<table class="D2"><tbody><tr><th><b>S_Name</b></th><th><b>S_Index</b> rs(<strong>0</strong>)</th></tr>
<tr><td>Boston</td><td>200</td></tr>
<tr><td>Los Angeles</td><td>1200</td></tr>
<tr><td>New Jersey</td><td>700</td></tr>
<tr><td>Taiwan</td><td>850</td></tr></tbody></table>
<p>統計倉庫名稱相同的庫存量，且條件庫存量需大於 <b class="n">1000</b> 的倉庫記錄。</p>
<p><b class="sql">HAVING</b> 子句是用來取代 <b class="sql">WHERE</b> 搭配聚合函數 <b>Aggregate Function</b> 進行條件查詢，因為 <b class="sql">WHERE</b> 不能與聚合函數一起使用。</p>
<pre class="lang-sql shCode highlight Brush-default shCode-has lines-scroll"><span class="kwd">SELECT</span><span class="pln"> S_Name</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">SUM</span><span class="pun">(</span><span class="pln">S_Qty</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp;</span><span class="kwd">FROM</span><span class="pln"> </span><span class="typ">Store_Information</span><span class="pln"><br>&nbsp; &nbsp;</span><span class="kwd">GROUP</span><span class="pln"> </span><span class="kwd">BY</span><span class="pln"> S_Name </span><span class="kwd">HAVING</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">SUM</span><span class="pun">(</span><span class="pln">S_Qty</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">1000</span><span class="pun">)</span></pre>
<table class="D2"><tbody><tr><th><b>S_Name</b></th><th><b>S_Qty</b> rs(<strong>1</strong>)</th></tr>
<tr><td>Boston</td><td>2600</td></tr>
<tr><td>Los Angeles</td><td>1200</td></tr>
<tr><td>San Diego</td><td>1500</td></tr></tbody></table>
<p>統計倉庫名稱相同的庫存量，且條件庫存量需小於 <b class="n">1000</b> 的倉庫記錄。</p>
<pre class="lang-sql shCode highlight Brush-default shCode-has lines-scroll"><span class="kwd">SELECT</span><span class="pln"> S_Name</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">SUM</span><span class="pun">(</span><span class="pln">S_Qty</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp;</span><span class="kwd">FROM</span><span class="pln"> </span><span class="typ">Store_Information</span><span class="pln"><br>&nbsp; &nbsp;</span><span class="kwd">GROUP</span><span class="pln"> </span><span class="kwd">BY</span><span class="pln"> S_Name </span><span class="kwd">HAVING</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">SUM</span><span class="pun">(</span><span class="pln">S_Qty</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln"> </span><span class="lit">1000</span><span class="pun">)</span></pre>
<table class="D2"><tbody><tr><th><b>S_Name</b></th><th><b>S_Qty</b> rs(<strong>1</strong>)</th></tr>
<tr><td>New Jersey</td><td>700</td></tr>
<tr><td>Taiwan</td><td>850</td></tr></tbody></table>
<h2><b>AVG</b> 平均值</h2>
<p>統計倉庫名稱相同的庫存量平均值。</p>
<pre class="lang-sql shCode highlight Brush-default shCode-has lines-scroll"><span class="kwd">SELECT</span><span class="pln"> S_Name</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">AVG</span><span class="pun">(</span><span class="pln">S_Qty</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp;</span><span class="kwd">FROM</span><span class="pln"> </span><span class="typ">Store_Information</span><span class="pln"> </span><span class="kwd">GROUP</span><span class="pln"> </span><span class="kwd">BY</span><span class="pln"> S_Name</span></pre>
<table class="D2"><tbody><tr><th><b>S_Name</b></th><th><b>S_Qty</b> rs(<strong>1</strong>)</th></tr>
<tr><td>Boston</td><td>866.666666666667</td></tr>
<tr><td>Los Angeles</td><td>600</td></tr>
<tr><td>New Jersey</td><td>700</td></tr>
<tr><td>San Diego</td><td>1500</td></tr>
<tr><td>Taiwan</td><td>850</td></tr></tbody></table>
<p>例如 <b class="o">Boston</b> = <b>1200 + 1200 + 200 = 2600 / 3</b> = <b>866.666666666667</b></p>
<h2><b>SQL BETWEEN</b> 包含在二個值之間的記錄資料</h2>
<p>列出庫存量在於 <b class="n">500</b> 與 <b class="n">1000</b> 之間的記錄。</p>
<pre class="lang-sql shCode highlight Brush-default shCode-has lines-scroll"><span class="kwd">SELECT</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> </span><span class="kwd">FROM</span><span class="pln"> </span><span class="typ">Store_Information</span><span class="pln"><br>&nbsp; &nbsp;</span><span class="kwd">WHERE</span><span class="pln"> S_Qty </span><span class="kwd">BETWEEN</span><span class="pln"> </span><span class="lit">500</span><span class="pln"> </span><span class="kwd">AND</span><span class="pln"> </span><span class="lit">1000</span></pre>
<table class="D4"><tbody><tr><th><b>S_Index</b></th><th><b>S_Name</b></th><th><b>S_Qty</b> rs(<strong>1</strong>)</th><th><b>S_Date</b></th></tr>
<tr><td>1</td><td>Los Angeles</td><td>900</td><td>2014/03/05</td></tr>
<tr><td>6</td><td>New Jersey</td><td>700</td><td>2014/03/18</td></tr>
<tr><td>7</td><td>Taiwan</td><td>850</td><td>2014/09/08</td></tr></tbody></table>
<p>列出倉庫名稱在於 <b class="g">'M'</b> 與 <b class="g">'Z'</b> 之間的記錄。</p>
<pre class="lang-sql shCode highlight Brush-default shCode-has lines-scroll"><span class="kwd">SELECT</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> </span><span class="kwd">FROM</span><span class="pln"> </span><span class="typ">Store_Information</span><span class="pln"><br>&nbsp; &nbsp;</span><span class="kwd">WHERE</span><span class="pln"> S_Qty </span><span class="kwd">BETWEEN</span><span class="pln"> </span><span class="str">'M'</span><span class="pln"> </span><span class="kwd">AND</span><span class="pln"> </span><span class="str">'Z'</span></pre>
<table class="D4"><tbody><tr><th><b>S_Index</b></th><th><b>S_Name</b></th><th><b>S_Qty</b> rs(<strong>1</strong>)</th><th><b>S_Date</b></th></tr>
<tr><td>2</td><td>San Diego</td><td>1500</td><td>2014/03/07</td></tr>
<tr><td>6</td><td>New Jersey</td><td>700</td><td>2014/03/18</td></tr>
<tr><td>7</td><td>Taiwan</td><td>850</td><td>2014/09/08</td></tr></tbody></table>
<p><b class="sql">BETWEEN</b> 相反的 <b class="sql">NOT BWTWEEN</b> 就是不包含在這範圍裡的的資料。</p>
<pre class="lang-sql shCode highlight Brush-default shCode-has lines-scroll"><span class="kwd">SELECT</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> </span><span class="kwd">FROM</span><span class="pln"> </span><span class="typ">Store_Information</span><span class="pln"><br>&nbsp; &nbsp;</span><span class="kwd">WHERE</span><span class="pln"> S_Qty </span><span class="kwd">NOT</span><span class="pln"> </span><span class="kwd">BETWEEN</span><span class="pln"> </span><span class="str">'M'</span><span class="pln"> </span><span class="kwd">AND</span><span class="pln"> </span><span class="str">'Z'</span></pre>
<table class="D4"><tbody><tr><th><b>S_Index</b></th><th><b>S_Name</b></th><th><b>S_Qty</b> rs(<strong>1</strong>)</th><th><b>S_Date</b></th></tr>
<tr><td>8</td><td>Boston</td><td>200</td><td>2014/03/10</td></tr>
<tr><td>1</td><td>Los Angeles</td><td>900</td><td>2014/03/05</td></tr>
<tr><td>3</td><td>Los Angeles</td><td>300</td><td>2014/03/12</td></tr>
<tr><td>4</td><td>Boston</td><td>1200</td><td>2014/03/08</td></tr>
<tr><td>5</td><td>Boston</td><td>1200</td><td>2014/03/08</td></tr></tbody></table>
</div></div>
<p class="create-date">Modification in <span data-delicate="2014/03/20"></span></p><div class="related-topic"><ul><li><a href="http://www.eion.com.tw/Blogger/?Pid=1016"><strong>SQL SELECT 資料庫處理基本指令 (一)</strong><span>SQL 基本常用指令將資料從(資料庫)中的(表格)內選出需要的資料</span></a></li>
<li><a href="http://www.eion.com.tw/Blogger/?Pid=1155"><strong>SQL Data Types 資料型別</strong><span>SQL Data Types 資料型別</span></a></li>
<li><a href="http://www.eion.com.tw/Blogger/?Pid=1171"><strong>LIKE 查詢出現執行階段錯誤 -2147217900 記憶體不足 (80040E14)</strong><span>資料庫中存入日文字元 LIKE 子句的 SELECT 陳述式下造成執行階段錯誤 -2147217900 記憶體不足</span></a></li>
<li><a href="http://www.eion.com.tw/Blogger/?Pid=1149"><strong>ASP Datetime 日期與時間格式應用, 計算兩個日期的期間</strong><span>計算兩個日期的期間、日期加上一段期間、日期與時間格式應用</span></a></li>
</ul></div>
<div class="post-topic">
<form name="Posted" method="post"><input type="hidden" name="Article" value="1174"><input type="hidden" name="UserName" value="Guest Caller"><p>回應文章</p><textarea name="Textually" rows="6" class="zh-tw"></textarea><a href="http://www.eion.com.tw/Membership/">請先登入</a></form></div>
</div><div class="categories"><div class="sidebar"><div class="search"><form name="cForm"><input type="text" name="sKeyword" value="部落格文章搜尋" autocomplete="off" maxlength="15"><span></span></form></div><ul class="domain"><li><a href="http://www.eion.com.tw/Blogger/?Pid=1000" class="cm">網域名稱註冊申請</a></li><li><a href="http://www.eion.com.tw/Blogger/?Pid=1049" class="cm">英文網域名稱繳費步驟</a></li><li><a href="http://www.eion.com.tw/Blogger/?Pid=1013" class="cm">企業郵件設定 <b>e-mail</b></a></li></ul><div class="sponsor-build mediums"><script async="" src="./SQL 找出欄位值重覆的記錄及刪除重複記錄_files/adsbygoogle.js"></script>
<ins class="adsbygoogle" style="display:inline-block;width:250px;height:250px" data-ad-client="ca-pub-3174848791099762" data-ad-slot="6700427941" data-adsbygoogle-status="done"><ins id="aswift_1_expand" style="display:inline-table;border:none;height:250px;margin:0;padding:0;position:relative;visibility:visible;width:250px;background-color:transparent"><ins id="aswift_1_anchor" style="display:block;border:none;height:250px;margin:0;padding:0;position:relative;visibility:visible;width:250px;background-color:transparent"><iframe width="250" height="250" frameborder="0" marginwidth="0" marginheight="0" vspace="0" hspace="0" allowtransparency="true" scrolling="no" allowfullscreen="true" onload="var i=this.id,s=window.google_iframe_oncopy,H=s&amp;&amp;s.handlers,h=H&amp;&amp;H[i],w=this.contentWindow,d;try{d=w.document}catch(e){}if(h&amp;&amp;d&amp;&amp;(!d.body||!d.body.firstChild)){if(h.call){setTimeout(h,0)}else if(h.match){try{h=s.upd(h,i)}catch(e){}w.location.replace(h)}}" id="aswift_1" name="aswift_1" style="left:0;position:absolute;top:0;width:250px;height:250px;" src="./SQL 找出欄位值重覆的記錄及刪除重複記錄_files/saved_resource(1).html"></iframe></ins></ins></ins>
<script>(adsbygoogle = window.adsbygoogle || []).push({});</script>
</div><ul class="categorization graphics"><li data-post="46"><a href="http://www.eion.com.tw/Blogger/?f=Category&amp;Categorization=Gallery" class="cm">電腦繪圖</a></li><li data-post="7"><a href="http://www.eion.com.tw/Blogger/?f=Category&amp;Categorization=Graphic" class="cm">平面設計</a></li><li data-post="32"><a href="http://www.eion.com.tw/Blogger/?f=Category&amp;Categorization=WebLayout" class="cm">網頁設計</a></li><li data-post="17"><a href="http://www.eion.com.tw/Blogger/?f=Category&amp;Categorization=CSS" class="cm"><b>CSS</b> 樣式</a></li><li data-post="28"><a href="http://www.eion.com.tw/Blogger/?f=Category&amp;Categorization=Programming" class="cm">程式語法</a></li><li data-post="23"><a href="http://www.eion.com.tw/Blogger/?f=Category&amp;Categorization=Hosting" class="cm">虛擬主機 <b>IIS</b></a></li><li data-post="22"><a href="http://www.eion.com.tw/Blogger/?f=Category&amp;Categorization=Diary" class="cm">設計資源</a></li><li data-post="10"><a href="http://www.eion.com.tw/Blogger/?f=Category&amp;Categorization=Forum" class="cm">軟體・設計討論</a></li></ul><div class="colored-pencils"><a href="http://cp-artist.blogspot.tw/" onclick="this.target=&#39;_blank&#39;"></a></div><ul class="categorization labs"><li data-post="10"><a href="http://www.eion.com.tw/Blogger/?f=Category&amp;Categorization=Apple" class="cm"><b>Apple</b> 蘋果電腦(行動裝置)</a></li><li data-post="3"><a href="http://www.eion.com.tw/Blogger/?f=Category&amp;Categorization=Labs" class="cm"><b>Labs</b> 實驗室</a></li></ul><div class="sponsor-build tower"><script async="" src="./SQL 找出欄位值重覆的記錄及刪除重複記錄_files/adsbygoogle.js"></script>
<ins class="adsbygoogle" style="display: block; height: 600px;" data-ad-client="ca-pub-3174848791099762" data-ad-slot="6448527282" data-ad-format="vertical" data-adsbygoogle-status="done"><ins id="aswift_2_expand" style="display:inline-table;border:none;height:600px;margin:0;padding:0;position:relative;visibility:visible;width:250px;background-color:transparent"><ins id="aswift_2_anchor" style="display:block;border:none;height:600px;margin:0;padding:0;position:relative;visibility:visible;width:250px;background-color:transparent"><iframe width="250" height="600" frameborder="0" marginwidth="0" marginheight="0" vspace="0" hspace="0" allowtransparency="true" scrolling="no" allowfullscreen="true" onload="var i=this.id,s=window.google_iframe_oncopy,H=s&amp;&amp;s.handlers,h=H&amp;&amp;H[i],w=this.contentWindow,d;try{d=w.document}catch(e){}if(h&amp;&amp;d&amp;&amp;(!d.body||!d.body.firstChild)){if(h.call){setTimeout(h,0)}else if(h.match){try{h=s.upd(h,i)}catch(e){}w.location.replace(h)}}" id="aswift_2" name="aswift_2" style="left:0;position:absolute;top:0;width:250px;height:600px;" src="./SQL 找出欄位值重覆的記錄及刪除重複記錄_files/saved_resource(2).html"></iframe></ins></ins></ins>
<script>(adsbygoogle = window.adsbygoogle || []).push({});</script>
</div></div></div></div></div><div class="frame-header" data-globals="2017070616"><div class="bar"><div style="width: 100%; opacity: 0.329189;"></div></div><div class="frame-matrix"><div class="header"><a class="co" href="http://www.eion.com.tw/Blogger/?f=zh-TW"></a><div class="across"><a class="en" href="http://www.eion.com.tw/">eion.com.tw</a><a class="tw" href="http://www.eion.com.tw/Membership/?f=Contact-Us">聯絡我們</a><a class="tw" href="http://www.eion.com.tw/Membership/">登入</a><a class="tw" href="http://www.eion.com.tw/Membership/?f=Member-Register">註冊</a><a class="tw" href="http://www.eion.com.tw/Blogger/">首頁</a></div></div><div class="nav" role="navigation"><ul class="n"><li class="m"><span><div class="mm"><div><ul class="touch"><li><a href="http://www.eion.com.tw/Blogger/" class="cm">部落格</a></li><li><a href="http://www.eion.com.tw/Blogger/?f=Optimization-Graphics" class="cm">產品繪圖</a></li><li><a href="http://www.eion.com.tw/Blogger/?f=BUSINESS-DESIGN" class="cm">商業設計</a></li><li><a href="http://www.eion.com.tw/Blogger/?f=WebLayout" class="cm">網頁設計</a></li></ul><ul class="touch"><li><a href="http://www.eion.com.tw/Blogger/?f=Search" class="cm">文章搜尋</a></li><li><a href="http://www.eion.com.tw/Blogger/?f=Web-Hosting" class="cm">虛擬主機</a></li><li><a href="http://www.eion.com.tw/Blogger/?f=Computer-Gallery-Steps" class="cm">動態圖像</a></li><li><b>文章分類</b></li></ul></div></div></span></li><li class="desktop"><a href="http://www.eion.com.tw/Blogger/" class="cm">部落格</a></li><li class="desktop"><a href="http://www.eion.com.tw/Blogger/?f=Computer-Gallery" class="cm">動態圖像</a></li><li><a href="http://www.eion.com.tw/Blogger/?f=Optimization-Graphics" class="cm">產品繪圖</a></li><li><a href="http://www.eion.com.tw/Blogger/?f=BUSINESS-DESIGN" class="cm">商業設計</a></li><li><a href="http://www.eion.com.tw/Blogger/?f=WebLayout" class="cm">網頁設計</a></li><li><a href="http://www.eion.com.tw/Blogger/?f=Search" class="cm">文章搜尋</a></li><li><span class="categories">文章分類</span></li></ul></div></div></div>
<div class="frame-footer"><div class="frame-matrix links"><ol><li class="logo"><a href="http://www.eion.com.tw/Blogger/" title="EION Blogger"></a></li><li class="row-c links"><a class="touch" href="http://www.eion.com.tw/Blogger/">部落格首頁</a><a href="http://www.eion.com.tw/">漢頡網棧</a><a href="http://www.eion.com.tw/Membership/?f=Contact-Us">聯絡我們</a><a class="touch" href="http://www.eion.com.tw/Blogger/?f=Industrial-Drawing">電子型錄設計</a><a href="http://www.eion.com.tw/WebLayout/">企業網站設計</a><a class="rm" href="http://www.eion.com.tw/Blogger/?f=Web-Design">響應式網頁設計</a><a href="http://www.eion.com.tw/Blogger/?f=Category&amp;Popular=Hot">熱點文章</a></li><li class="row-t links"><a href="http://www.eion.com.tw/Blogger/?Pid=1059" title="RealFlow 10 Dyverso Solver Granular">Dyverso 模擬沙或雪的粒子效果</a><a href="http://www.eion.com.tw/Blogger/?Pid=1001">Glu3D 模擬液態攪拌效果</a><a href="http://www.eion.com.tw/Blogger/?Pid=1026">行星齒輪動態模擬</a><a href="http://www.eion.com.tw/Blogger/?Pid=1108">摩擦式扭力限制器</a><a href="http://www.eion.com.tw/Blogger/?Pid=1111">複合式滾珠軸承</a></li><li class="row-t links"><a href="http://www.eion.com.tw/Blogger/?Pid=1055">常用數學符號</a><a href="http://www.eion.com.tw/Blogger/?Pid=1030">向量台灣地圖 map</a><a href="http://www.eion.com.tw/Blogger/?Pid=1063">環保標誌, 綠色環保標章</a><a href="http://www.eion.com.tw/Blogger/?Pid=1065">UKAS 認證標章(皇冠標誌)</a><a href="http://www.eion.com.tw/Blogger/?Pid=1113">HTML ISO-8859-1 拉丁字母編碼表</a></li></ol><cite class="g"></cite></div>
<div class="footer"><div class="frame-matrix footer-bar"><p class="contentinfo" role="contentinfo"><b>TM+ © 2002-2017 <a href="http://www.eion.com.tw/" class="studio">hANjAN STUDIO</a><span class="author"> and author.</span></b><span data-server="WWW.EION.COM.TW|True" class="return-bug">回報錯誤</span></p><div class="return-bug"></div></div></div></div></div>

</body></html>